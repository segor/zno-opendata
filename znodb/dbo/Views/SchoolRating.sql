-- Raiting for every year with school information actual on that year

CREATE VIEW [dbo].[SchoolRating] 
AS 
SELECT TOP 100000000  
	   R.[ZnoYear]
      ,[TotalRank]
      ,[MedTotalRank]
      ,[IT_Rank]
      ,[UmlRank]
      ,[UkrRank]
      ,[MathRank]
      ,[PhysRank]
      ,[EngRank]
      ,[HistRank]
      ,[ChemRank]
      ,[BioRank]
      ,[AvgScore]
      ,[MedScore]
      ,[EOName]
      ,[EOAreaFullName]
      ,[Examinees]
      ,[FailedExams]
      ,[PassRate]
      ,[StdDevScore]
      ,[IT_AvgScore]
      ,[UmlAvg]
      ,[UmlStDev]
      ,[UmlMed]
      ,[UmlN]
      ,[UkrAvg]
      ,[UkrStDev]
      ,[UkrMed]
      ,[UkrN]
      ,[HistAvg]
      ,[HistStDev]
      ,[HistMed]
      ,[HistN]
      ,[MathAvg]
      ,[MathStDev]
      ,[MathMed]
      ,[MathN]
      ,[PhysAvg]
      ,[PhysStDev]
      ,[PhysMed]
      ,[PhysN]
      ,[ChemAvg]
      ,[ChemStDev]
      ,[ChemMed]
      ,[ChemN]
      ,[BioAvg]
      ,[BioStDev]
      ,[BioMed]
      ,[BioN]
      ,[GeoAvg]
      ,[GeoStDev]
      ,[GeoMed]
      ,[GeoN]
      ,[EngAvg]
      ,[EngStDev]
      ,[EngMed]
      ,[EngN]
      ,[FrAvg]
      ,[FrStDev]
      ,[FrMed]
      ,[FrN]
      ,[DeuAvg]
      ,[DeuStDev]
      ,[DeuMed]
      ,[DeuN]
      ,[SpAvg]
      ,[SpStDev]
      ,[SpMed]
      ,[SpN]
      ,[RusAvg]
      ,[RusStDev]
      ,[RusMed]
      ,[RusN]
      ,[EOTypeName]
      ,[TerType]
      ,[IsPrivate]
      ,R.[EOHash]
      ,R.[EOHash_Merge] 
	  ,SortOrder
  FROM [dbo].[SchoolRatingShort] AS R
  INNER JOIN [dbo].[Schools] S on (R.ZnoYear = S.ZnoYear) AND (R.EOHash = S.EOHash)
  ORDER BY R.ZnoYear, SortOrder