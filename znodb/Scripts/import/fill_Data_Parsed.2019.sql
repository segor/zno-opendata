PRINT N'ZNO-$(ZnoYear): Parsing imported CSV data...'
GO

INSERT INTO [dbo].Data_Parsed
 WITH(TABLOCK)
SELECT 
	$(ZnoYear) AS ZnoYear,
	dbo.clean_str(OutID) AS OutID,
	dbo.clean_str(Birth) AS Birth,
	dbo.clean_str(SexTypeName) AS SexTypeName,
	dbo.clean_str(Regname) AS Regname,
	dbo.clean_str(AreaName) AS AreaName,
	dbo.clean_str(TerName) AS TerName,
	dbo.clean_str(RegTypeName) AS RegTypeName,
	dbo.clean_str(TerTypeName) AS TerTypeName,
	dbo.clean_str(ClassProfileNAME) AS ClassProfileNAME,
	dbo.clean_str(ClassLangName) AS ClassLangName,
	dbo.clean_str(EOName) AS EOName,
	dbo.clean_str(EOTypeName) AS EOTypeName,
	dbo.clean_str(EORegName) AS EORegName,
	dbo.clean_str(EOAreaName) AS EOAreaName,
	dbo.clean_str(EOTerName) AS EOTerName,
	dbo.clean_str(EOParent) AS EOParent,
	dbo.clean_str(UkrTest) AS UkrTest,
	dbo.clean_str(UkrTestStatus) AS UkrTestStatus,
	CAST (dbo.clean_num(UkrBall100) as DECIMAL(4,1)) AS UkrBall100,
	dbo.clean_num(UkrBall12) AS UkrBall12,
	dbo.clean_num(UkrBall) AS UkrBall,
	dbo.clean_str(UkrAdaptScale) AS UkrAdaptScale,
	dbo.clean_str(UkrPTName) AS UkrPTName,
	dbo.clean_str(UkrPTRegName) AS UkrPTRegName,
	dbo.clean_str(UkrPTAreaName) AS UkrPTAreaName,
	dbo.clean_str(UkrPTTerName) AS UkrPTTerName,
	dbo.clean_str(HistTest) AS HistTest,
	dbo.clean_str(HistLang) AS HistLang,
	dbo.clean_str(HistTestStatus) AS HistTestStatus,
	dbo.clean_num(HistBall100) AS HistBall100,
	dbo.clean_num(HistBall12) AS HistBall12,
	dbo.clean_num(HistBall) AS HistBall,
	dbo.clean_str(HistPTName) AS HistPTName,
	dbo.clean_str(HistPTRegName) AS HistPTRegName,
	dbo.clean_str(HistPTAreaName) AS HistPTAreaName,
	dbo.clean_str(HistPTTerName) AS HistPTTerName,
	dbo.clean_str(MathTest) AS MathTest,
	dbo.clean_str(MathLang) AS MathLang,
	dbo.clean_str(MathTestStatus) AS MathTestStatus,
	dbo.clean_num(MathBall100) AS MathBall100,
	dbo.clean_num(MathBall12) AS MathBall12,
	dbo.clean_num(MathBall) AS MathBall,
	dbo.clean_str(MathPTName) AS MathPTName,
	dbo.clean_str(MathPTRegName) AS MathPTRegName,
	dbo.clean_str(MathPTAreaName) AS MathPTAreaName,
	dbo.clean_str(MathPTTerName) AS MathPTTerName,
	dbo.clean_str(PhysTest) AS PhysTest,
	dbo.clean_str(PhysLang) AS PhysLang,
	dbo.clean_str(PhysTestStatus) AS PhysTestStatus,
	dbo.clean_num(PhysBall100) AS PhysBall100,
	dbo.clean_num(PhysBall12) AS PhysBall12,
	dbo.clean_num(PhysBall) AS PhysBall,
	dbo.clean_str(PhysPTName) AS PhysPTName,
	dbo.clean_str(PhysPTRegName) AS PhysPTRegName,
	dbo.clean_str(PhysPTAreaName) AS PhysPTAreaName,
	dbo.clean_str(PhysPTTerName) AS PhysPTTerName,
	dbo.clean_str(ChemTest) AS ChemTest,
	dbo.clean_str(ChemLang) AS ChemLang,
	dbo.clean_str(ChemTestStatus) AS ChemTestStatus,
	dbo.clean_num(ChemBall100) AS ChemBall100,
	dbo.clean_num(ChemBall12) AS ChemBall12,
	dbo.clean_num(ChemBall) AS ChemBall,
	dbo.clean_str(ChemPTName) AS ChemPTName,
	dbo.clean_str(ChemPTRegName) AS ChemPTRegName,
	dbo.clean_str(ChemPTAreaName) AS ChemPTAreaName,
	dbo.clean_str(ChemPTTerName) AS ChemPTTerName,
	dbo.clean_str(BioTest) AS BioTest,
	dbo.clean_str(BioLang) AS BioLang,
	dbo.clean_str(BioTestStatus) AS BioTestStatus,
	dbo.clean_num(BioBall100) AS BioBall100,
	dbo.clean_num(BioBall12) AS BioBall12,
	dbo.clean_num(BioBall) AS BioBall,
	dbo.clean_str(BioPTName) AS BioPTName,
	dbo.clean_str(BioPTRegName) AS BioPTRegName,
	dbo.clean_str(BioPTAreaName) AS BioPTAreaName,
	dbo.clean_str(BioPTTerName) AS BioPTTerName,
	dbo.clean_str(GeoTest) AS GeoTest,
	dbo.clean_str(GeoLang) AS GeoLang,
	dbo.clean_str(GeoTestStatus) AS GeoTestStatus,
	dbo.clean_num(GeoBall100) AS GeoBall100,
	dbo.clean_num(GeoBall12) AS GeoBall12,
	dbo.clean_num(GeoBall) AS GeoBall,
	dbo.clean_str(GeoPTName) AS GeoPTName,
	dbo.clean_str(GeoPTRegName) AS GeoPTRegName,
	dbo.clean_str(GeoPTAreaName) AS GeoPTAreaName,
	dbo.clean_str(GeoPTTerName) AS GeoPTTerName,
	dbo.clean_str(EngTest) AS EngTest,
	dbo.clean_str(EngTestStatus) AS EngTestStatus,
	dbo.clean_num(EngBall100) AS EngBall100,
	dbo.clean_num(EngBall12) AS EngBall12,
	dbo.clean_str(EngDPALevel) AS EngDPALevel,
	dbo.clean_num(EngBall) AS EngBall,
	dbo.clean_str(EngPTName) AS EngPTName,
	dbo.clean_str(EngPTRegName) AS EngPTRegName,
	dbo.clean_str(EngPTAreaName) AS EngPTAreaName,
	dbo.clean_str(EngPTTerName) AS EngPTTerName,
	dbo.clean_str(FraTest) AS FrTest,
	dbo.clean_str(FraTestStatus) AS FrTestStatus,
	dbo.clean_num(FraBall100) AS FrBall100,
	dbo.clean_num(FraBall12) AS FrBall12,
	dbo.clean_str(FraDPALevel) AS FrDPALevel,
	dbo.clean_num(FraBall) AS FrBall,
	dbo.clean_str(FraPTName) AS FrPTName,
	dbo.clean_str(FraPTRegName) AS FrPTRegName,
	dbo.clean_str(FraPTAreaName) AS FrPTAreaName,
	dbo.clean_str(FraPTTerName) AS FrPTTerName,
	dbo.clean_str(DeuTest) AS DeuTest,
	dbo.clean_str(DeuTestStatus) AS DeuTestStatus,
	dbo.clean_num(DeuBall100) AS DeuBall100,
	dbo.clean_num(DeuBall12) AS DeuBall12,
	dbo.clean_str(DeuDPALevel) AS DeuDPALevel,
	dbo.clean_num(DeuBall) AS DeuBall,
	dbo.clean_str(DeuPTName) AS DeuPTName,
	dbo.clean_str(DeuPTRegName) AS DeuPTRegName,
	dbo.clean_str(DeuPTAreaName) AS DeuPTAreaName,
	dbo.clean_str(DeuPTTerName) AS DeuPTTerName,
	dbo.clean_str(SpaTest) AS SpTest,
	dbo.clean_str(SpaTestStatus) AS SpTestStatus,
	dbo.clean_num(SpaBall100) AS SpBall100,
	dbo.clean_num(SpaBall12) AS SpBall12,
	dbo.clean_str(SpaDPALevel) AS SpDPALevel,
	dbo.clean_num(SpaBall) AS SpBall,
	dbo.clean_str(SpaPTName) AS SpPTName,
	dbo.clean_str(SpaPTRegName) AS SpPTRegName,
	dbo.clean_str(SpaPTAreaName) AS SpPTAreaName,
	dbo.clean_str(SpaPTTerName) AS SpPTTerName,
	NULL AS RusTest,
	NULL AS RusTestStatus,
	NULL AS RusBall100,
	NULL AS RusBall12,
	NULL AS RusPTName,
	NULL AS RusPTRegName,
	NULL AS RusPTAreaName,
	NULL AS RusPTTerName
FROM [zno$(ZnoYear)].Data_csv

GO

TRUNCATE TABLE [zno$(ZnoYear)].Data_csv
GO
